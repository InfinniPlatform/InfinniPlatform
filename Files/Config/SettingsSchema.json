{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "AppCommon",
    "description": "InfinniPlatform common application settings.",
    "type": "object",
    "properties": {
        "app": {
            "description": "Настройки приложения.",
            "type": "object",
            "properties": {
                "Name": {
                    "description": "Уникальное имя приложения, используется для изоляции данных между приложениями.",
                    "type": "string",
                    "default": "InfinniPlatform"
                },
                "InstanceId": {
                    "description": "Идентификатор текущего экземпляра приложения (по умолчанию - NetBIOS имя машины + имя рабочей директории).",
                    "type": "string"
                }
            },
            "required": [
                "Name",
                "InstanceId"
            ]
        },
        "host": {
            "description": "Настройки хостинга приложения",
            "type": "object",
            "properties": {
                "Name": {
                    "description": "Адрес или доменное имя.",
                    "type": "string",
                    "default": "localhost"
                },
                "Port": {
                    "description": "Номер порта.",
                    "type": "integer",
                    "default": 9900
                }
            },
            "required": [
                "Name",
                "Port"
            ]
        },
        "redis": {
            "description": "Настройки подключения к Redis.",
            "type": "object",
            "properties": {
                "Host": {
                    "description": "Адрес или доменное имя.",
                    "type": "string",
                    "default": "localhost"
                },
                "Port": {
                    "description": "Номер порта.",
                    "type": "integer",
                    "default": 6379
                },
                "Database": {
                    "description": "Номер базы данных.",
                    "type": "integer",
                    "default": 0
                },
                "Password": {
                    "description": "Пароль подключения.",
                    "type": "string",
                    "default": null
                },
                "ReadBufferSize": {
                    "description": "Размер буфера чтения.",
                    "type": "integer",
                    "default": 512
                },
                "WriteBufferSize": {
                    "description": "Размер буфера записи.",
                    "type": "integer",
                    "default": 512
                },
                "ConnectionTimeout": {
                    "description": "Таймаут подключения в миллисекундах (0 - отсутствие таймаута).",
                    "type": "integer",
                    "default": 0
                },
                "MaxReconnectRetries": {
                    "description": "Количество попыток подключения.",
                    "type": "integer",
                    "default": 10
                },
                "PoolSize": {
                    "description": "Размер пула подключений (0 - неограничен).",
                    "type": "integer",
                    "default": 0
                }
            },
            "required": [
                "Host",
                "Port",
                "Database",
                "Password",
                "ReadBufferSize",
                "WriteBufferSize",
                "ConnectionTimeout",
                "MaxReconnectRetries",
                "PoolSize"
            ]
        },
        "mongodb": {
            "description": "Настройки подключения к MongoDB.",
            "type": "object",
            "properties": {
                "Nodes": {
                    "description": "Список узлов кластера. Каждый узел должен быть представлен в формате 'host:port'.",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "default": [
                        "localhost:27017"
                    ]
                },
                "UserName": {
                    "description": "Имя пользователя в механизме аутентификации. Начиная с MongoDB 3.0 по умолчанию используется SCRAM-SHA-1 вместо MONGODB-CR).",
                    "type": "string",
                    "default": null
                },
                "Password": {
                    "description": "Пароль пользователя в механизме аутентификации. Начиная с MongoDB 3.0 по умолчанию используется SCRAM-SHA-1 вместо MONGODB-CR)",
                    "type": "string",
                    "default": null
                }
            },
            "required": [
                "Nodes",
                "UserName",
                "Password"
            ]
        },
        "rabbitmq": {
            "description": "Настройки подключения к RabbitMQ.",
            "type": "object",
            "properties": {
                "HostName": {
                    "description": "Адрес или доменное имя.",
                    "type": "string",
                    "default": "localhost"
                },
                "Port": {
                    "description": "Номер порта.",
                    "type": "integer",
                    "default": 5672
                },
                "UserName": {
                    "description": "Имя пользователя.",
                    "type": "string",
                    "default": "guest"
                },
                "Password": {
                    "description": "Пароль пользователя.",
                    "type": "string",
                    "default": "guest"
                },
                "ManagementApiPort": {
                    "description": "Номер порта для RabbitMQ Management HTTP API.",
                    "type": "integer",
                    "default": 15672
                },
                "PrefetchCount": {
                    "description": "Количество сообщений, единовременно передаваемых потребителю.",
                    "type": "integer",
                    "default": 1000
                },
                "MaxConcurrentThreads": {
                    "description": "Максимальное количество одновременно обрабатываемых сообщений.",
                    "type": "integer",
                    "default": 200
                },
                "ReconnectTimeout": {
                    "description": "Время между попытками переподключения к серверу RabbitMQ в cекундах.",
                    "type": "integer",
                    "default": 5
                }
            },
            "required": [
                "HostName",
                "Port",
                "UserName",
                "Password",
                "ManagementApiPort",
                "PrefetchCount",
                "MaxConcurrentThreads",
                "ReconnectTimeout"
            ]
        },
        "blobStorage": {
            "description": "Настройки хранения BLOB и файлов.",
            "type": "object",
            "properties": {
                "BaseDirectory": {
                    "description": "Базовый каталог для хранения файлов системы.",
                    "type": "string",
                    "default": "BlobStorage"
                }
            },
            "required": [
                "BaseDirectory"
            ]
        },
        "userStorage": {
            "description": "Настройки хранения пользователей.",
            "type": "object",
            "properties": {
                "UserCacheTimeout": {
                    "description": "Таймаут сброса кэша пользователей в минутах.",
                    "type": "integer",
                    "default": 30,
                    "minimum": 1
                }
            },
            "required": [
                "UserCacheTimeout"
            ]
        },
        "cache": {
            "description": "Настройки кэширования данных.",
            "type": "object",
            "properties": {
                "Type": {
                    "description": "Тип кэша для приложения.",
                    "type": "string",
                    "enum": [
                        "Memory",
                        "Shared"
                    ],
                    "default": "Memory"
                }
            },
            "required": [
                "Type"
            ]
        },
        "printView": {
            "description": "Настройки печатных представлений.",
            "type": "object",
            "properties": {
                "HtmlToPdfUtilCommand": {
                    "description": "Местоположение утилиты wkhtmltopdf.",
                    "type": "string"
                },
                "HtmlToPdfUtilArguments": {
                    "description": "Формат аргументов утилиты wkhtmltopdf.",
                    "type": "string"
                },
                "HtmlToPdfTemp": {
                    "description": "Каталог для хранения временных файлов при генерации HTML/PDF (по умолчанию - каталог временных файлов учетной записи пользователя).",
                    "type": "string"
                }
            },
            "required": [
                "HtmlToPdfUtilCommand",
                "HtmlToPdfUtilArguments",
                "HtmlToPdfTemp"
            ]
        },
        "metadata": {
            "description": "Настройки хранения метаданных.",
            "type": "object",
            "properties": {
                "DocumentsPath": {
                    "description": "Путь до подкаталога  с файлами метаданных документов.",
                    "type": "string",
                    "default": "content/metadata/Documents"
                },
                "PrintViewsPath": {
                    "description": "Путь до подкаталога  с файлами метаданных печатных представлений.",
                    "type": "string",
                    "default": "content/metadata/PrintViews"
                }
            },
            "required": [
                "DocumentsPath",
                "PrintViewsPath"
            ]
        },
        "scheduler": {
            "description": "Планировщик заданий.",
            "type": "object",
            "properties": {
                "ExpireHistoryAfter": {
                    "description": "Время хранения информации о вызове обработчиков заданий (в секундах, по умолчанию - время хранения не ограничено)",
                    "type": "integer"
                }
            },
            "required": [
                "ExpireHistoryAfter"
            ]
        },
        "staticContent": {
            "description": "Настройки хостинга статических файлов.",
            "type": "object",
            "properties": {
                "StaticFilesMapping": {
                    "description": "Соответствие виртуальных и физических путей до статических файлов.",
                    "type": "object",
                    "properties": {}
                },
                "EmbeddedResourceMapping": {
                    "description": "Соответствие виртуальных путей и сборок с файлами ресурсов.",
                    "type": "object",
                    "properties": {}
                },
                "RazorViewsPath": {
                    "description": "Путь до файлов Razor-представлений (относительно рабочей папки, по умолчанию - content/RazorViews)",
                    "type": "string",
                    "default": "content/RazorViews"
                },
                "EmbeddedRazorViewsAssemblies": {
                    "description": "Путь до файлов Razor-представлений (относительно рабочей папки, по умолчанию - content/RazorViews)",
                    "type": "array",
                    "items": {}
                }
            },
            "required": [
                "StaticFilesMapping",
                "EmbeddedResourceMapping",
                "RazorViewsPath",
                "EmbeddedRazorViewsAssemblies"
            ]
        },
        "authCookie": {
            "description": "Настройки аутентификации через Cookie.",
            "type": "object",
            "properties": {
                "CookieDomain": {
                    "description": "Домен для создания cookie. При развертывании в кластере - указать шаблон. Если равен '.mycluster.local', тогда 'node1.mycluster.local' и 'node2.mycluster.local' будут считаться допустимыми.",
                    "type": "string",
                    "default": null
                }
            },
            "required": [
                "CookieDomain"
            ]
        },
        "authAdfs": {
            "description": "Настройки аутентификации через ADFS.",
            "type": "object",
            "properties": {
                "Enable": {
                    "description": "Разрешает аутентификацию через ADFS.",
                    "type": "boolean",
                    "default": false
                },
                "Server": {
                    "description": "Адрес сервера ADFS (например, 'myadfs.org:1234').",
                    "type": "string",
                    "default": null
                },
                "ResourceUri": {
                    "description": "URI защищенного ресурса ADFS (например, 'https://InfinniPlatform').",
                    "type": "string",
                    "default": null
                }
            },
            "required": [
                "Enable",
                "Server",
                "ResourceUri"
            ]
        },
        "authGoogle": {
            "description": "Настройки аутентификации через Google+.",
            "type": "object",
            "properties": {
                "Enable": {
                    "description": "Разрешает аутентификацию через Google+.",
                    "type": "boolean",
                    "default": false
                },
                "ClientId": {
                    "description": "ClientId приложения в Google+.",
                    "type": "string",
                    "default": null
                },
                "ClientSecret": {
                    "description": "ClientSecret приложения в Google+.",
                    "type": "string",
                    "default": null
                }
            },
            "required": [
                "Enable",
                "ClientId",
                "ClientSecret"
            ]
        },
        "authFacebook": {
            "description": "Настройки аутентификации через Facebook.",
            "type": "object",
            "properties": {
                "Enable": {
                    "description": "Разрешает аутентификацию через Facebook.",
                    "type": "boolean",
                    "default": false
                },
                "ClientId": {
                    "description": "ClientId приложения в Facebook.",
                    "type": "string",
                    "default": null
                },
                "ClientSecret": {
                    "description": "ClientSecret приложения в Facebook.",
                    "type": "string",
                    "default": null
                }
            },
            "required": [
                "Enable",
                "ClientId",
                "ClientSecret"
            ]
        },
        "authVk": {
            "description": "Настройки аутентификации через ВКонтакте.",
            "type": "object",
            "properties": {
                "Enable": {
                    "description": "Разрешает аутентификацию через ВКонтакте.",
                    "type": "boolean",
                    "default": false
                },
                "ClientId": {
                    "description": "ClientId приложения в ВКонтакте.",
                    "type": "string",
                    "default": null
                },
                "ClientSecret": {
                    "description": "ClientSecret приложения в ВКонтакте.",
                    "type": "string",
                    "default": null
                }
            },
            "required": [
                "Enable",
                "ClientId",
                "ClientSecret"
            ]
        }
    },
    "required": [
        "app",
        "host",
        "redis",
        "mongodb",
        "rabbitmq",
        "blobStorage",
        "userStorage",
        "cache",
        "printView",
        "metadata",
        "scheduler",
        "staticContent",
        "authCookie",
        "authAdfs",
        "authGoogle",
        "authFacebook",
        "authVk"
    ]
}